<!DOCTYPE html> 
<html lang="pt-br">
    <head>
        <meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
	
		<link href="css/estilo.css" rel="stylesheet">

        <style>
            .buscaDiv{
                margin: 50px;
            }

            .dica{
                visibility: visible;
            }

            textarea{
                width: 90%;
            }
        </style>
    </head>
    <body>
        <div class="buscaDiv">
            <input type="text" class="busca"><a class="btn btnBusca">Buscar</a>
        </div>
        <div class="resultados"></div>

        <script>
            let inputBusca = document.querySelector('.busca');
            let btnBusca = document.querySelector('.btnBusca');
            let resultados = document.querySelector('.resultados');

            inputBusca.focus();

            btnBusca.addEventListener('click', procuraPersonagem);
            document.addEventListener('keyup', function(e){
                if(e.keyCode === 13){
                    procuraPersonagem();
                }
            })

            async function procuraPersonagem(){
                let personagemProcurado = inputBusca.value;

                let url = "http://localhost:3000/perguntas";
                let promise = await fetch(url);

                if(!promise.ok){
                    alert("Deu ruim");
                }

                let personagem = await promise.json();


                personagem.forEach((element, index) => {
                    element = Object.values(element);                    
                    let _element = element[0];
                    if(_element === personagemProcurado){
                         elementEncontrado(element);
                    }
                })

                function elementEncontrado(el){
                    let levelPergunta = el[11];
                    let _level = undefined;

                    switch(levelPergunta){
                        case "Fácil":
                            _level = "easy";
                            break;
                        case "Médio":
                            _level = "medium";
                            break;
                        case "Difícil":
                            _level = "hard";
                            break;
                        default:
                            alert("Alguma coisa deu errado com o nível da pergunta");  
                    }

                    resultados.innerHTML = ` 
                    <div class="container caixaPerguntas">
                    <div class="dificuldade ${_level}">${el[11]}</div>
                    <span class="CodigoDaPergunta h1 mr-3">0${el[12]}</span><span class="h1 personagem">Personagem:</span><span class="h2 p-2">${el[0]}</span>
                    <div class="dicasPersonagens">
                        <div class="metade1">
                            <div class="divPai">
                                <div class="divDicas"><span class="mr-2 ml-1 number">1</span><span class="dica"><textarea>${el[1]}</textarea></span></div>
                            </div>
                            <br>
                            <div class="divPai">
                                <div class="divDicas"><span class="mr-2 ml-1 number">2</span><span class="dica"><textarea>${el[2]}</textarea></span></div>
                            </div>
                            <br>
                            <div class="divPai">
                                <div class="divDicas"><span class="mr-2 ml-1 number">3</span><span class="dica"><textarea>${el[3]}</textarea></span></div>
                            </div>
                            <br>
                            <div class="divPai">
                                <div class="divDicas"><span class="mr-2 ml-1 number">4</span><span class="dica"><textarea>${el[4]}</textarea></span></div>
                            </div>
                            <br>
                            <div class="divPai">
                                <div class="divDicas"><span class="mr-2 ml-1 number">5</span><span class="dica"><textarea>${el[5]}</textarea></span></div>
                            </div>
                            <br>
                        </div>
                        
                        <div class="metade2">
                            <div class="divPai">
                                <div class="divDicas"><span class="mr-2 ml-1 number">6</span><span class="dica"><textarea>${el[6]}</textarea></span></div>
                            </div>
                            <br>
                            <div class="divPai">
                                <div class="divDicas"><span class="mr-2 ml-1 number">7</span><span class="dica"><textarea>${el[7]}</textarea></span></div>
                            </div>
                            <br>
                            <div class="divPai">
                                <div class="divDicas"><span class="mr-2 ml-1 number">8</span><span class="dica"><textarea>${el[8]}</textarea></span></div>
                            </div>
                            <br>
                            <div class="divPai">
                                <div class="divDicas"><span class="mr-2 ml-1 number">9</span><span class="dica"><textarea>${el[9]}</textarea></span></div>
                            </div>
                            <br>
                            <div class="divPai">
                                <div class="divDicas"><span class="mr-2 ml-1 number">10</span><span class="dica"><textarea>${el[10]}</textarea></span></div>
                            </div>
                            <br>
                    </div>	
                    </div>
                            <span class="verPersonagem btn mb-5">Ver resposta</span>
                            <span class="btn proximo mb-5">Próximo</span>
                    </div>`
                    }
                   
            }


            // async function getUser(id){
        //     let url = `https://jsonplaceholder.typicode.com/users/${id}`;           
        //     let promise  = await fetch(url);
            
        //     if(!promise.ok){
        //         throw new Error('FALHOU --- ')
        //     }            
            
        //     let usuario = await promise.json();
            
        //     return usuario;
                
        // }
        
        // function mostraUsuarios(usuario){   
        //     adicionarElemento($listaUsuarios, 'dt', usuario.id);
        //     adicionarElemento($listaUsuarios, 'dd', usuario.name, usuario.email, usuario.phone, usuario. website);  
        // }
        
    
        // function adicionarElemento(container, tag, ...text){
            
        //     [...text].forEach( str => {
        //         let _tag = document.createElement(tag);
        //         let _textNode = document.createTextNode(str);
        //         _tag.appendChild(_textNode);
        //         container.appendChild(_tag);
                
        //     } )
        // }
        
        
        // getUser(1)
        //     .then( resposta => {
        //         console.log('---sucesso');
        //         console.log(resposta);
        //         mostraUsuarios(resposta);
        //     return getUser(2);
        //     } )
        //     .then( resposta => {
        //         console.log('---sucesso');
        //         console.log(resposta);
        //         mostraUsuarios(resposta);
        //         return getUser('3a');
        //     } )
        //     .then( resposta => {
        //         console.log('---sucesso');
        //         console.log(resposta);
        //         mostraUsuarios(resposta);
        //         return getUser(4);
        //     } )
        //     .then( resposta => {
        //         console.log('---sucesso');
        //         console.log(resposta);
        //         mostraUsuarios(resposta);
        //     } )
        //     .catch( err => {
        //         console.log('---erro')
        //         console.log(err.message);
        //     } )
        </script>
    </body>
</html>