<!DOCTYPE html> 
<html lang="pt-br">
    <head>
        <meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
	
		<link href="css/estilo.css" rel="stylesheet">

        <style>
            btn{
                cursor: pointer;
            }
        </style>
    </head>
    <body>

        <input type="text" class="namePersonagem"><btn class="btnPersonagem">Pesquisar personagem</btn>
        <input type="text" class="idPersonagem"><btn class="btnId">Pesquisar ID</btn>
        
        <script>
            const valuePersonagemBtn = document.querySelector('.namePersonagem');
            const btnPersonagem = document.querySelector('.btnPersonagem');
            const valuePersonagemId = document.querySelector('.idPersonagem');
            const btnId = document.querySelector('.btnId');

            btnPersonagem.addEventListener('click', procuraPersonagem);

            function procuraPersonagem(){
                let personagemBuscado = valuePersonagemBtn.value;
                personagemBuscado = personagemBuscado.toLowerCase();
                
                if(personagemBuscado === ""){
                    alert("Digite um personagem");
                }

                ajaxGet(personagemBuscado);

            }

            function ajaxGet(personagem){
                let xhr = new XMLHttpRequest();
                let url = "http://localhost:3000/perguntas";
                xhr.open("GET", url);
                xhr.setRequestHeader("Content-type", "application/json;charset=UTF-8");
                xhr.send(null);
                xhr.onreadystatechange = verificaAjax;

                function verificaAjax(){
                    if(xhr.readyState === 4){
                        if(xhr.status < 400){
                            const json = JSON.parse(xhr.responseText);
                            viewList(json);
                        }else{
                            alert("Deu ruim");
                        }
                    }
                }

                function viewList(information){
                    var x = 0;
                    while(x < information.length){
                        let arr = [];
                        let personagens = information[x].personagem;
                        personagens = personagens.toLowerCase();
                        if(personagens == personagem){
                            console.log("Deu certo")
                        }else{
                            console.log("Deu ruim")
                        }
                        x++;
                    }
                    
                }
            }
        </script>
    </body>
</html>